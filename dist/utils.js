System.register(["lodash"], function (exports_1, context_1) {
    "use strict";
    var lodash_1;
    var __moduleName = context_1 && context_1.id;
    function GetDecimalsForValue(value, panelDecimals) {
        if (lodash_1.default.isNumber(panelDecimals)) {
            return { decimals: panelDecimals, scaledDecimals: null };
        }
        var delta = value / 2;
        var dec = -Math.floor(Math.log(delta) / Math.LN10);
        var magn = Math.pow(10, -dec), norm = delta / magn, size;
        if (norm < 1.5) {
            size = 1;
        }
        else if (norm < 3) {
            size = 2;
            if (norm > 2.25) {
                size = 2.5;
                ++dec;
            }
        }
        else if (norm < 7.5) {
            size = 5;
        }
        else {
            size = 10;
        }
        size *= magn;
        if (Math.floor(value) === value) {
            dec = 0;
        }
        var result = {
            decimals: 0,
            scaledDecimals: 0,
        };
        result.decimals = Math.max(0, dec);
        result.scaledDecimals = result.decimals - Math.floor(Math.log(size) / Math.LN10) + 2;
        return result;
    }
    exports_1("GetDecimalsForValue", GetDecimalsForValue);
    function getTextSizeForWidth(text, font, width, minFontPx, maxFontPx) {
        var s = font.replace("?", maxFontPx);
        var w = getTextWidth(text, s);
        if (w <= width) {
            return maxFontPx;
        }
        width = width - 20;
        for (var fontSize = maxFontPx; fontSize >= minFontPx; fontSize--) {
            s = font.replace("?", fontSize);
            w = getTextWidth(text, s);
            if (w < width) {
                return Math.ceil(fontSize);
            }
        }
        return 0;
    }
    exports_1("getTextSizeForWidth", getTextSizeForWidth);
    function getTextSizeForWidthAndHeight(text, font, width, height, minFontPx, maxFontPx) {
        var s = font.replace("?", maxFontPx);
        var w = getTextWidth(text, s);
        width = width - 72;
        if ((w <= width) && (maxFontPx <= height)) {
            return maxFontPx;
        }
        for (var fontSize = maxFontPx; fontSize >= minFontPx; fontSize--) {
            s = font.replace("?", fontSize);
            w = getTextWidth(text, s);
            if ((w < width) && (fontSize <= height)) {
                return Math.ceil(fontSize);
            }
        }
        return 0;
    }
    exports_1("getTextSizeForWidthAndHeight", getTextSizeForWidthAndHeight);
    function getTextWidth(text, font) {
        var canvas = document.createElement("canvas");
        var context = canvas.getContext("2d");
        context.font = font;
        var metrics = context.measureText(text);
        return metrics.width;
    }
    exports_1("getTextWidth", getTextWidth);
    function RGBToHex(text) {
        if (!text.startsWith("rgb")) {
            return text;
        }
        var hex = "#FFFFFF";
        try {
            var a = text.split("(")[1].split(")")[0];
            var b = a.split(",");
            var c = b.map(function (x) {
                x = parseInt(x, 10).toString(16);
                return (x.length === 1) ? "0" + x : x;
            });
            hex = "#" + c.join("");
        }
        catch (e) {
            return hex;
        }
        return hex;
    }
    exports_1("RGBToHex", RGBToHex);
    return {
        setters: [
            function (lodash_1_1) {
                lodash_1 = lodash_1_1;
            }
        ],
        execute: function () {
        }
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztJQU1BLDZCQUE2QixLQUFVLEVBQUUsYUFBa0I7UUFDekQsSUFBSSxnQkFBQyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsRUFBRTtZQUM3QixPQUFPLEVBQUMsUUFBUSxFQUFFLGFBQWEsRUFBRSxjQUFjLEVBQUUsSUFBSSxFQUFDLENBQUM7U0FDeEQ7UUFFRCxJQUFJLEtBQUssR0FBRyxLQUFLLEdBQUcsQ0FBQyxDQUFDO1FBQ3RCLElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUVuRCxJQUFJLElBQUksR0FBRyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUN6QixJQUFJLEdBQUcsS0FBSyxHQUFHLElBQUksRUFDbkIsSUFBSSxDQUFDO1FBRVQsSUFBSSxJQUFJLEdBQUcsR0FBRyxFQUFFO1lBQ2QsSUFBSSxHQUFHLENBQUMsQ0FBQztTQUNWO2FBQU0sSUFBSSxJQUFJLEdBQUcsQ0FBQyxFQUFFO1lBQ25CLElBQUksR0FBRyxDQUFDLENBQUM7WUFFVCxJQUFJLElBQUksR0FBRyxJQUFJLEVBQUU7Z0JBQ2YsSUFBSSxHQUFHLEdBQUcsQ0FBQztnQkFDWCxFQUFFLEdBQUcsQ0FBQzthQUNQO1NBQ0Y7YUFBTSxJQUFJLElBQUksR0FBRyxHQUFHLEVBQUU7WUFDckIsSUFBSSxHQUFHLENBQUMsQ0FBQztTQUNWO2FBQU07WUFDTCxJQUFJLEdBQUcsRUFBRSxDQUFDO1NBQ1g7UUFFRCxJQUFJLElBQUksSUFBSSxDQUFDO1FBR2IsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxLQUFLLEtBQUssRUFBRTtZQUFFLEdBQUcsR0FBRyxD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QyxPQUFPLE9BQU8sQ0FBQyxLQUFLLENBQUM7SUFDdkIsQ0FBQzs7SUFFRCxrQkFBa0IsSUFBWTtRQUU1QixJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsRUFBRTtZQUMzQixPQUFPLElBQUksQ0FBQztTQUNiO1FBQ0QsSUFBSSxHQUFHLEdBQUcsU0FBUyxDQUFDO1FBQ3BCLElBQUk7WUFDRixJQUFJLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUN6QyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBQ3JCLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBUyxDQUFDO2dCQUN0QixDQUFDLEdBQUcsUUFBUSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDLENBQUM7Z0JBQ2pDLE9BQU8sQ0FBQyxDQUFDLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDeEMsQ0FBQyxDQUFDLENBQUM7WUFDSCxHQUFHLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUM7U0FDeEI7UUFBQyxPQUFPLENBQUMsRUFBRTtZQUNWLE9BQU8sR0FBRyxDQUFDO1NBQ1o7UUFDRCxPQUFPLEdBQUcsQ0FBQztJQUNiLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLy8vLzxyZWZlcmVuY2UgcGF0aD1cIi4uL25vZGVfbW9kdWxlcy9AdHlwZXMvbG9kYXNoL2luZGV4LmQudHNcIiAvPlxuXG4vLyBpbXBvcnQgeyBpc051bWJlciB9IGZyb20gXCJsb2Rhc2hcIjtcbmltcG9ydCBfIGZyb20gXCJsb2Rhc2hcIjtcbi8vaW1wb3J0IF8gPSByZXF1aXJlKFwibG9kYXNoXCIpO1xuXG5mdW5jdGlvbiBHZXREZWNpbWFsc0ZvclZhbHVlKHZhbHVlOiBhbnksIHBhbmVsRGVjaW1hbHM6IGFueSk6IHsgZGVjaW1hbHM7IHNjYWxlZERlY2ltYWxzOyB9IHtcbiAgaWYgKF8uaXNOdW1iZXIocGFuZWxEZWNpbWFscykpIHtcbiAgICByZXR1cm4ge2RlY2ltYWxzOiBwYW5lbERlY2ltYWxzLCBzY2FsZWREZWNpbWFsczogbnVsbH07XG4gIH1cblxuICB2YXIgZGVsdGEgPSB2YWx1ZSAvIDI7XG4gIHZhciBkZWMgPSAtTWF0aC5mbG9vcihNYXRoLmxvZyhkZWx0YSkgLyBNYXRoLkxOMTApO1xuXG4gIHZhciBtYWduID0gTWF0aC5wb3coMTAsIC1kZWMpLFxuICAgICAgbm9ybSA9IGRlbHRhIC8gbWFnbiwgLy8gbm9ybSBpcyBiZXR3ZWVuIDEuMCBhbmQgMTAuMFxuICAgICAgc2l6ZTtcblxuICBpZiAobm9ybSA8IDEuNSkge1xuICAgIHNpemUgPSAxO1xuICB9IGVsc2UgaWYgKG5vcm0gPCAzKSB7XG4gICAgc2l6ZSA9IDI7XG4gICAgLy8gc3BlY2lhbCBjYXNlIGZvciAyLjUsIHJlcXVpcmVzIGFuIGV4dHJhIGRlY2ltYWxcbiAgICBpZiAobm9ybSA+IDIuMjUpIHtcbiAgICAgIHNpemUgPSAyLjU7XG4gICAgICArK2RlYztcbiAgICB9XG4gIH0gZWxzZSBpZiAobm9ybSA8IDcuNSkge1xuICAgIHNpemUgPSA1O1xuICB9IGVsc2Uge1xuICAgIHNpemUgPSAxMDtcbiAgfVxuXG4gIHNpemUgKj0gbWFnbjtcblxuICAvLyByZWR1Y2Ugc3RhcnRpbmcgZGVjaW1hbHMgaWYgbm90IG5lZWRlZFxuICBpZiAoTWF0aC5mbG9vcih2YWx1ZSkgPT09IHZhbHVlKSB7IGRlYyA9IDA7IH1cblxuICB2YXIgcmVzdWx0ID0ge1xuICAgIGRlY2ltYWxzOiAwLFxuICAgIHNjYWxlZERlY2ltYWxzOiAwLFxuICB9O1xuICByZXN1bHQuZGVjaW1hbHMgPSBNYXRoLm1heCgwLCBkZWMpO1xuICByZXN1bHQuc2NhbGVkRGVjaW1hbHMgPSByZXN1bHQuZGVjaW1hbHMgLSBNYXRoLmZsb29yKE1hdGgubG9nKHNpemUpIC8gTWF0aC5MTjEwKSArIDI7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICpcbiAqXG4gKiBGaW5kIHRoZSBsYXJnZXN0IGZvbnQgc2l6ZSAoaW4gcGl4ZWxzKSB0aGF0IGFsbG93cyB0aGUgc3RyaW5nIHRvIGZpdCBpbiB0aGUgZ2l2ZW4gd2lkdGguXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHRleHQgVGhlIHRleHQgdG8gYmUgcmVuZGVyZWQuXG4gKiBAcGFyYW0ge1N0cmluZ30gZm9udCBUaGUgY3NzIGZvbnQgZGVzY3JpcHRvciB0aGF0IHRleHQgaXMgdG8gYmUgcmVuZGVyZWQgd2l0aCAoZS5nLiBcImJvbGQgP3B4IHZlcmRhbmFcIilcbiAqICAgICAgICAgICAgICAgICAgICAgIC0tIG5vdGUgdGhlIHVzZSBvZiA/IGluIHBsYWNlIG9mIHRoZSBmb250IHNpemUuXG4gKiBAcGFyYW0ge3dpZHRofSB0aGUgd2lkdGggaW4gcGl4ZWxzIHRoZSBzdHJpbmcgbXVzdCBmaXQgaW5cbiAqIEBwYXJhbSB7bWluRm9udFB4fSB0aGUgc21hbGxlc3QgYWNjZXB0YWJsZSBmb250IHNpemUgaW4gcGl4ZWxzXG4gKiBAcGFyYW0ge21heEZvbnRQeH0gdGhlIGxhcmdlc3QgYWNjZXB0YWJsZSBmb250IHNpemUgaW4gcGl4ZWxzXG4qKi9cbmZ1bmN0aW9uIGdldFRleHRTaXplRm9yV2lkdGgodGV4dDogc3RyaW5nLCBmb250OiBhbnksIHdpZHRoLCBtaW5Gb250UHgsIG1heEZvbnRQeCkge1xuICAgIHZhciBzID0gZm9udC5yZXBsYWNlKFwiP1wiLCBtYXhGb250UHgpO1xuICAgIHZhciB3ID0gZ2V0VGV4dFdpZHRoKHRleHQsIHMpO1xuICAgIGlmICh3IDw9IHdpZHRoKSB7XG4gICAgICByZXR1cm4gbWF4Rm9udFB4O1xuICAgIH1cbiAgICAvLyBwYWQgd2lkdGggYnkgMTBweFxuICAgIHdpZHRoID0gd2lkdGggLSAyMDtcbiAgICAvLyBzdGFydCBmcm9tIGxhcmdlIHRvIHNtYWxsLCByZXR1cm4gMCBmb3Igbm8tZml0XG4gICAgZm9yIChsZXQgZm9udFNpemUgPSBtYXhGb250UHg7IGZvbnRTaXplID49IG1pbkZvbnRQeDsgZm9udFNpemUtLSkge1xuICAgICAgcyA9IGZvbnQucmVwbGFjZShcIj9cIiwgZm9udFNpemUpO1xuICAgICAgdyA9IGdldFRleHRXaWR0aCh0ZXh0LCBzKTtcbiAgICAgIGlmICh3IDwgd2lkdGgpIHtcbiAgICAgICAgcmV0dXJuIE1hdGguY2VpbChmb250U2l6ZSk7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIDAgaWYgbm8gZml0XG4gICAgcmV0dXJuIDA7XG59XG5cbi8qKlxuICpcbiAqXG4gKiBGaW5kIHRoZSBsYXJnZXN0IGZvbnQgc2l6ZSAoaW4gcGl4ZWxzKSB0aGF0IGFsbG93cyB0aGUgc3RyaW5nIHRvIGZpdCBpbiB0aGUgZ2l2ZW4gd2lkdGguXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHRleHQgVGhlIHRleHQgdG8gYmUgcmVuZGVyZWQuXG4gKiBAcGFyYW0ge1N0cmluZ30gZm9udCBUaGUgY3NzIGZvbnQgZGVzY3JpcHRvciB0aGF0IHRleHQgaXMgdG8gYmUgcmVuZGVyZWQgd2l0aCAoZS5nLiBcImJvbGQgP3B4IHZlcmRhbmFcIilcbiAqICAgICAgICAgICAgICAgICAgICAgIC0tIG5vdGUgdGhlIHVzZSBvZiA/IGluIHBsYWNlIG9mIHRoZSBmb250IHNpemUuXG4gKiBAcGFyYW0ge3dpZHRofSB0aGUgd2lkdGggaW4gcGl4ZWxzIHRoZSBzdHJpbmcgbXVzdCBmaXQgaW5cbiAqIEBwYXJhbSB7aGVpZ2h0fSB0aGUgaGVpZ2h0IGluIHBpeGVsc1xuICogQHBhcmFtIHttaW5Gb250UHh9IHRoZSBzbWFsbGVzdCBhY2NlcHRhYmxlIGZvbnQgc2l6ZSBpbiBwaXhlbHNcbiAqIEBwYXJhbSB7bWF4Rm9udFB4fSB0aGUgbGFyZ2VzdCBhY2NlcHRhYmxlIGZvbnQgc2l6ZSBpbiBwaXhlbHNcbioqL1xuZnVuY3Rpb24gZ2V0VGV4dFNpemVGb3JXaWR0aEFuZEhlaWdodCh0ZXh0OiBzdHJpbmcsIGZvbnQ6IGFueSwgd2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIsIG1pbkZvbnRQeDogbnVtYmVyLCBtYXhGb250UHg6IG51bWJlcikge1xuICB2YXIgcyA9IGZvbnQucmVwbGFjZShcIj9cIiwgbWF4Rm9udFB4KTtcbiAgdmFyIHcgPSBnZXRUZXh0V2lkdGgodGV4dCwgcyk7XG4gIC8vIG5lZWQgdG8gcGFkIHRoZSB3aWR0aCB0byBhbGxvdyBzcGFjZSBvbiBlYWNoIHNpZGVcbiAgd2lkdGggPSB3aWR0aCAtIDcyO1xuICAvL2NvbnNvbGUubG9nKFwiRXN0aW1hdGluZyBzaXplIGZvciB0ZXh0OiBcIiArIHRleHQgKyBcIiBpbnNpZGUgd2lkdGg6IFwiICsgd2lkdGggKyBcIiB1c2luZyBmb250OiBcIiArIGZvbnQpO1xuICBpZiAoKHcgPD0gd2lkdGgpICYmIChtYXhGb250UHggPD0gaGVpZ2h0KSkge1xuICAgIHJldHVybiBtYXhGb250UHg7XG4gIH1cbiAgLy8gc3RhcnQgZnJvbSBsYXJnZSB0byBzbWFsbCwgcmV0dXJuIDAgZm9yIG5vLWZpdFxuICBmb3IgKGxldCBmb250U2l6ZSA9IG1heEZvbnRQeDsgZm9udFNpemUgPj0gbWluRm9udFB4OyBmb250U2l6ZS0tKSB7XG4gICAgcyA9IGZvbnQucmVwbGFjZShcIj9cIiwgZm9udFNpemUpO1xuICAgIHcgPSBnZXRUZXh0V2lkdGgodGV4dCwgcyk7XG4gICAgLy9jb25zb2xlLmxvZyhcImNhbGMgd2lkdGggPSBcIiArIHcpO1xuICAgIC8vIGhhcyB0byBmaXQgd2l0aGluIHRoZSB3aWR0aCBvZiB0aGUgdGV4dCBhcmVhLCBhbmQgbm90IGV4Y2VlZCB0aGUgaGVpZ2h0XG4gICAgaWYgKCh3IDwgd2lkdGgpICYmIChmb250U2l6ZSA8PSBoZWlnaHQpKSB7XG4gICAgICAvL2NvbnNvbGUubG9nKFwiZXN0aW1hdGVkIHNpemU6IFwiICsgTWF0aC5jZWlsKGZvbnRTaXplKSk7XG4gICAgICByZXR1cm4gTWF0aC5jZWlsKGZvbnRTaXplKTtcbiAgICB9XG4gIH1cbiAgLy8gMCBpZiBubyBmaXRcbiAgcmV0dXJuIDA7XG59XG5cbi8qKlxuICogVXNlcyBjYW52YXMubWVhc3VyZVRleHQgdG8gY29tcHV0ZSBhbmQgcmV0dXJuIHRoZSB3aWR0aCBvZiB0aGUgZ2l2ZW4gdGV4dCBvZiBnaXZlbiBmb250IGluIHBpeGVscy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gdGV4dCBUaGUgdGV4dCB0byBiZSByZW5kZXJlZC5cbiAqIEBwYXJhbSB7U3RyaW5nfSBmb250IFRoZSBjc3MgZm9udCBkZXNjcmlwdG9yIHRoYXQgdGV4dCBpcyB0byBiZSByZW5kZXJlZCB3aXRoIChlLmcuIFwiYm9sZCAxNHB4IHZlcmRhbmFcIikuXG4gKlxuICogQHNlZSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8xMTgyNDEvY2FsY3VsYXRlLXRleHQtd2lkdGgtd2l0aC1qYXZhc2NyaXB0LzIxMDE1MzkzIzIxMDE1MzkzXG4gKi9cbmZ1bmN0aW9uIGdldFRleHRXaWR0aCh0ZXh0OiBzdHJpbmcsIGZvbnQ6IHN0cmluZykge1xuICAvLyByZS11c2UgY2FudmFzIG9iamVjdCBmb3IgYmV0dGVyIHBlcmZvcm1hbmNlXG4gIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG4gIGNvbnRleHQuZm9udCA9IGZvbnQ7XG4gIHZhciBtZXRyaWNzID0gY29udGV4dC5tZWFzdXJlVGV4dCh0ZXh0KTtcbiAgcmV0dXJuIG1ldHJpY3Mud2lkdGg7XG59XG5cbmZ1bmN0aW9uIFJHQlRvSGV4KHRleHQ6IHN0cmluZykge1xuICAvLyBjaGVjayBpZiBpbiByZ2Igbm90YXRpb25cbiAgaWYgKCF0ZXh0LnN0YXJ0c1dpdGgoXCJyZ2JcIikpIHtcbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuICBsZXQgaGV4ID0gXCIjRkZGRkZGXCI7XG4gIHRyeSB7XG4gICAgbGV0IGEgPSB0ZXh0LnNwbGl0KFwiKFwiKVsxXS5zcGxpdChcIilcIilbMF07XG4gICAgbGV0IGIgPSBhLnNwbGl0KFwiLFwiKTtcbiAgICBsZXQgYyA9IGIubWFwKGZ1bmN0aW9uKHgpIHsgICAgICAgICAgICAgICAvLyBGb3IgZWFjaCBhcnJheSBlbGVtZW50XG4gICAgICB4ID0gcGFyc2VJbnQoeCwgMTApLnRvU3RyaW5nKDE2KTsgICAgICAgLy8gQ29udmVydCB0byBhIGJhc2UxNiBzdHJpbmdcbiAgICAgIHJldHVybiAoeC5sZW5ndGggPT09IDEpID8gXCIwXCIgKyB4IDogeDsgIC8vIEFkZCB6ZXJvIGlmIHdlIGdldCBvbmx5IG9uZSBjaGFyYWN0ZXJcbiAgICB9KTtcbiAgICBoZXggPSBcIiNcIiArIGMuam9pbihcIlwiKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBoZXg7XG4gIH1cbiAgcmV0dXJuIGhleDtcbn1cblxuZXhwb3J0IHtcbkdldERlY2ltYWxzRm9yVmFsdWUsXG5nZXRUZXh0U2l6ZUZvcldpZHRoLFxuZ2V0VGV4dFNpemVGb3JXaWR0aEFuZEhlaWdodCxcbmdldFRleHRXaWR0aCxcblJHQlRvSGV4XG59O1xuIl19