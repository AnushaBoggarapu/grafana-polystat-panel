System.register([], function (exports_1, context_1) {
    "use strict";
    var __moduleName = context_1 && context_1.id;
    function getWorstSeries(series1, series2) {
        var worstSeries = series1;
        var series1Value = getValueByStatName(series1.operatorName, series1);
        var series2Value = getValueByStatName(series2.operatorName, series2);
        var series1result = getThresholdLevelForValue(series1.thresholds, series1Value);
        var series2result = getThresholdLevelForValue(series2.thresholds, series2Value);
        if (series2result.thresholdLevel > series1result.thresholdLevel) {
            worstSeries = series2;
        }
        if (series1result.thresholdLevel === 3) {
            switch (series2result.thresholdLevel) {
                case 1:
                    worstSeries = series2;
                    break;
                case 2:
                    worstSeries = series2;
                    break;
            }
        }
        return worstSeries;
    }
    exports_1("getWorstSeries", getWorstSeries);
    function getThresholdLevelForValue(thresholds, value) {
        var colorGrey = "#808080";
        var colorWhite = "#FFFFFF";
        var currentColor = colorWhite;
        if (value === null) {
            return { thresholdLevel: 3, color: colorGrey };
        }
        var currentState = -1;
        if (typeof thresholds === "undefined") {
            return { thresholdLevel: currentState, color: colorWhite };
        }
        var thresholdCount = thresholds.length;
        if (thresholdCount === 0) {
            return { thresholdLevel: currentState, color: colorWhite };
        }
        var aThreshold = thresholds[thresholdCount - 1];
        if (value >= aThreshold.value) {
            currentState = aThreshold.state;
            currentColor = aThreshold.color;
        }
        if (thresholds.length === 1) {
            return { thresholdLevel: currentState, color: currentColor };
        }
        for (var i = thresholdCount - 1; i > 0; i--) {
            var upperThreshold = thresholds[i];
            var lowerThreshold = thresholds[i - 1];
            if ((lowerThreshold.value <= value) && (value < upperThreshold.value)) {
                if (currentState < lowerThreshold.state) {
                    currentState = lowerThreshold.state;
                    currentColor = lowerThreshold.color;
                }
            }
        }
        if (currentState === -1) {
            currentState = thresholds[0].state;
            currentColor = thresholds[0].color;
        }
        return { thresholdLevel: currentState, color: currentColor };
    }
    exports_1("getThresholdLevelForValue", getThresholdLevelForValue);
    function getValueByStatName(operatorName, data) {
        var value = data.stats.avg;
        switch (operatorName) {
            case "avg":
                value = data.stats.avg;
                break;
            case "count":
                value = data.stats.count;
                break;
            case "current":
                value = data.stats.current;
                break;
            case "delta":
                value = data.stats.delta;
                break;
            case "diff":
                value = data.stats.diff;
                break;
            case "first":
                value = data.stats.first;
                break;
            case "logmin":
                value = data.stats.logmin;
                break;
            case "max":
                value = data.stats.max;
                break;
            case "min":
                value = data.stats.min;
                break;
            case "name":
                value = data.metricName;
                break;
            case "time_step":
                value = data.stats.timeStep;
                break;
            case "last_time":
                value = data.timestamp;
                break;
            case "total":
                value = data.stats.total;
                break;
            default:
                value = data.stats.avg;
                break;
        }
        return value;
    }
    exports_1("getValueByStatName", getValueByStatName);
    return {
        setters: [],
        execute: function () {
        }
    };
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGhyZXNob2xkX3Byb2Nlc3Nvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy90aHJlc2hvbGRfcHJvY2Vzc29yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztJQXFEQSx3QkFBd0IsT0FBWSxFQUFFLE9BQVk7UUFDaEQsSUFBSSxXQUFXLEdBQUcsT0FBTyxDQUFDO1FBQzFCLElBQUksWUFBWSxHQUFHLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDckUsSUFBSSxZQUFZLEdBQUcsa0JBQWtCLENBQUMsT0FBTyxDQUFDLFlBQVksRUFBRSxPQUFPLENBQUMsQ0FBQztRQUNyRSxJQUFJLGFBQWEsR0FBRyx5QkFBeUIsQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLFlBQVksQ0FBQyxDQUFDO1FBQ2hGLElBQUksYUFBYSxHQUFHLHlCQUF5QixDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsWUFBWSxDQUFDLENBQUM7UUFHaEYsSUFBSSxhQUFhLENBQUMsY0FBYyxHQUFHLGFBQWEsQ0FBQyxjQUFjLEVBQUU7WUFFL0QsV0FBVyxHQUFHLE9BQU8sQ0FBQztTQUN2QjtRQUNELElBQUksYUFBYSxDQUFDLGNBQWMsS0FBSyxDQUFDLEVBQUU7WUFFdEMsUUFBUSxhQUFhLENBQUMsY0FBYyxFQUFFO2dCQUNwQyxLQUFLLENBQUM7b0JBQ0osV0FBVyxHQUFHLE9BQU8sQ0FBQztvQkFDdEIsTUFBTTtnQkFDUixLQUFLLENBQUM7b0JBQ0osV0FBVyxHQUFHLE9BQU8sQ0FBQztvQkFDeEIsTUFBTTthQUNQO1NBQ0Y7UUFDRCxPQUFPLFdBQVcsQ0FBQztJQUNyQixDQUFDOztJQUVELG1DQUFtQyxVQUFlLEVBQUUsS0FBYTtRQUMvRCxJQUFJLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDMUIsSUFBSSxVQUFVLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksWUFBWSxHQUFHLFVBQVUsQ0FBQztRQUM5QixJQUFJLEtB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TTtZQUNSLEtBQUssUUFBUTtnQkFDWCxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7Z0JBQzFCLE1BQU07WUFDUixLQUFLLEtBQUs7Z0JBQ1IsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO2dCQUN2QixNQUFNO1lBQ1IsS0FBSyxLQUFLO2dCQUNSLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQztnQkFDdkIsTUFBTTtZQUNSLEtBQUssTUFBTTtnQkFDVCxLQUFLLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztnQkFDeEIsTUFBTTtZQUNSLEtBQUssV0FBVztnQkFDZCxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUM7Z0JBQzVCLE1BQU07WUFDUixLQUFLLFdBQVc7Z0JBQ2QsS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7Z0JBQ3ZCLE1BQU07WUFDUixLQUFLLE9BQU87Z0JBQ1YsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDO2dCQUN6QixNQUFNO1lBQ1I7Z0JBQ0UsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDO2dCQUN2QixNQUFNO1NBQ1I7UUFDRixPQUFPLEtBQUssQ0FBQztJQUNmLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuXG5UaGlzIHN1cHBvcnRzIHJhbmdlZCBzdGF0ZXNcblxuVGhyZXNob2xkcyBhcmUgZXhwZWN0ZWQgdG8gYmUgc29ydGVkIGJ5IGFzY2VuZGluZyB2YWx1ZSwgd2hlcmVcbiAgVDAgPSBsb3dlc3QgZGVjaW1hbCB2YWx1ZSwgYW55IHN0YXRlXG4gIFROID0gaGlnaGVzdCBkZWNpbWFsIHZhbHVlLCBhbnkgc3RhdGVcblxuSW5pdGlhbCBzdGF0ZSBpcyBzZXQgdG8gXCJva1wiXG5cbkEgY29tcGFyaXNvbiBpcyBtYWRlIHVzaW5nIFwiZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvXCIgYWdhaW5zdCB0aGUgdmFsdWVcbiAgSWYgdmFsdWUgPj0gdGhyZXNob2xkVmFsdWUgc3RhdGUgPSBYXG5cbkNvbXBhcmlzb25zIGFyZSBtYWRlIGluIHJldmVyc2Ugb3JkZXIsIHVzaW5nIHRoZSByYW5nZSBiZXR3ZWVuIHRoZSBOdGggKGluY2x1c2l2ZSkgdGhyZXNob2xkIGFuZCBOKzEgKGV4Y2x1c2l2ZSlcbiAgSW5jbHVzaXZlVmFsdWUgPSBUKG4pLnZhbHVlXG4gIEV4Y2x1c2l2ZVZhbHVlID0gVChuKzEpLnZhbHVlXG5cbldoZW4gdGhlcmUgaXMgbm8gbisxIHRocmVzaG9sZCwgdGhlIGhpZ2hlc3QgdmFsdWUgdGhyZXNob2xkIFQobiksIGEgc2ltcGxlIGluY2x1c2l2ZSA+PSBjb21wYXJpc29uIGlzIG1hZGVcblxuICBFeGFtcGxlIDE6ICh0eXBpY2FsIGxpbmVhcilcbiAgICBUMCAtIDUsIG9rXG4gICAgVDEgLSAxMCwgd2FybmluZ1xuICAgIFQyIC0gMjAsIGNyaXRpY2FsXG5cbiAgVmFsdWUgPj0gMjAgKFZhbHVlID49IFQyKVxuICAxMCA8PSBWYWx1ZSA8IDIwICAoVDEgPD0gVmFsdWUgPCBUMilcbiAgNSA8PSBWYWx1ZSA8IDEwICAgKFQwIDw9IFZhbHVlIDwgVDEpXG5cbiAgRXhhbXBsZSAyOiAocmV2ZXJzZSBsaW5lYXIpXG4gICAgVDAgLSA1MCwgY3JpdGljYWxcbiAgICBUMSAtIDkwLCB3YXJuaW5nXG4gICAgVDIgLSAxMDAsIG9rXG5cbiAgVmFsdWUgPj0gMTAwXG4gIDkwIDw9IHZhbHVlIDwgMTAwXG4gIDUwIDw9IHZhbHVlIDwgOTBcblxuICBFeGFtcGxlIDM6IChib3VuZGVkKVxuICAgIFQwIC0gNTAsIGNyaXRpY2FsXG4gICAgVDEgLSA2MCwgd2FybmluZ1xuICAgIFQyIC0gNzAsIG9rXG4gICAgVDMgLSA4MCwgd2FybmluZ1xuICAgIFQ0IC0gOTAsIGNyaXRpY2FsXG5cbiAgICBWYWx1ZSA+PSA5MFxuICAgIDgwIDw9IFZhbHVlIDwgOTBcbiAgICA3MCA8PSBWYWx1ZSA8IDgwXG4gICAgNjAgPD0gVmFsdWUgPCA3MFxuICAgIDUwIDw9IFZhbHVlIDwgNjBcblxuVGhlIFwid29yc3RcIiBzdGF0ZSBpcyByZXR1cm5lZCBhZnRlciBjaGVja2luZyBldmVyeSB0aHJlc2hvbGQgcmFuZ2VcblxuKi9cbmZ1bmN0aW9uIGdldFdvcnN0U2VyaWVzKHNlcmllczE6IGFueSwgc2VyaWVzMjogYW55KTogYW55IHtcbiAgdmFyIHdvcnN0U2VyaWVzID0gc2VyaWVzMTtcbiAgdmFyIHNlcmllczFWYWx1ZSA9IGdldFZhbHVlQnlTdGF0TmFtZShzZXJpZXMxLm9wZXJhdG9yTmFtZSwgc2VyaWVzMSk7XG4gIHZhciBzZXJpZXMyVmFsdWUgPSBnZXRWYWx1ZUJ5U3RhdE5hbWUoc2VyaWVzMi5vcGVyYXRvck5hbWUsIHNlcmllczIpO1xuICB2YXIgc2VyaWVzMXJlc3VsdCA9IGdldFRocmVzaG9sZExldmVsRm9yVmFsdWUoc2VyaWVzMS50aHJlc2hvbGRzLCBzZXJpZXMxVmFsdWUpO1xuICB2YXIgc2VyaWVzMnJlc3VsdCA9IGdldFRocmVzaG9sZExldmVsRm9yVmFsdWUoc2VyaWVzMi50aHJlc2hvbGRzLCBzZXJpZXMyVmFsdWUpO1xuXG4gIC8vIFN0YXRlIDMgaXMgVW5rbm93biBhbmQgaXMgbm90IGJlIHdvcnNlIHRoYW4gQ1JJVElDQUwgKHN0YXRlIDIpXG4gIGlmIChzZXJpZXMycmVzdWx0LnRocmVzaG9sZExldmVsID4gc2VyaWVzMXJlc3VsdC50aHJlc2hvbGRMZXZlbCkge1xuICAgIC8vIHNlcmllczIgaGFzIGhpZ2hlciB0aHJlc2hvbGQgdmlvbGF0aW9uXG4gICAgd29yc3RTZXJpZXMgPSBzZXJpZXMyO1xuICB9XG4gIGlmIChzZXJpZXMxcmVzdWx0LnRocmVzaG9sZExldmVsID09PSAzKSB7XG4gICAgLy8gc2VyaWVzMSBpcyBpbiBzdGF0ZSB1bmtub3duLCBjaGVjayBpZiBzZXJpZXMyIGlzIGluIHN0YXRlIDEgb3IgMlxuICAgIHN3aXRjaCAoc2VyaWVzMnJlc3VsdC50aHJlc2hvbGRMZXZlbCkge1xuICAgICAgY2FzZSAxOlxuICAgICAgICB3b3JzdFNlcmllcyA9IHNlcmllczI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICB3b3JzdFNlcmllcyA9IHNlcmllczI7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHdvcnN0U2VyaWVzO1xufVxuXG5mdW5jdGlvbiBnZXRUaHJlc2hvbGRMZXZlbEZvclZhbHVlKHRocmVzaG9sZHM6IGFueSwgdmFsdWU6IG51bWJlcik6IHt0aHJlc2hvbGRMZXZlbDogbnVtYmVyLCBjb2xvcjogc3RyaW5nfSB7XG4gIGxldCBjb2xvckdyZXkgPSBcIiM4MDgwODBcIjsgLy8gXCJncmV5XCJcbiAgbGV0IGNvbG9yV2hpdGUgPSBcIiNGRkZGRkZcIjsgLy8gXCJ3aGl0ZVwiXG4gIGxldCBjdXJyZW50Q29sb3IgPSBjb2xvcldoaXRlO1xuICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAvL2NvbnNvbGUubG9nKFwiZ2V0VGhyZXNob2xkTGV2ZWxGb3JWYWx1ZTogTk8gREFUQVwiKTtcbiAgICByZXR1cm4geyB0aHJlc2hvbGRMZXZlbDogMywgY29sb3I6IGNvbG9yR3JleX07IC8vIE5vIERhdGFcbiAgfVxuICAvLyBhc3N1bWUgVU5LTk9XTiBzdGF0ZVxuICBsZXQgY3VycmVudFN0YXRlID0gLTE7XG4gIC8vIHNraXAgZXZhbHVhdGlvbiB3aGVuIHRoZXJlIGFyZSBubyB0aHJlc2hvbGRzXG4gIGlmICh0eXBlb2YgdGhyZXNob2xkcyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIC8vY29uc29sZS5sb2coXCJnZXRUaHJlc2hvbGRMZXZlbEZvclZhbHVlOiBOTyB0aHJlc2hvbGRzIGRlZmluZWRcIik7XG4gICAgcmV0dXJuIHsgdGhyZXNob2xkTGV2ZWw6IGN1cnJlbnRTdGF0ZSwgY29sb3I6IGNvbG9yV2hpdGV9O1xuICB9XG4gIC8vIHRlc3QgXCJOdGhcIiB0aHJlc2hvbGRcbiAgbGV0IHRocmVzaG9sZENvdW50ID0gdGhyZXNob2xkcy5sZW5ndGg7XG4gIGlmICh0aHJlc2hvbGRDb3VudCA9PT0gMCkge1xuICAgIC8vY29uc29sZS5sb2coXCJnZXRUaHJlc2hvbGRMZXZlbEZvclZhbHVlOiBOTyB0aHJlc2hvbGRzIGRlZmluZWRcIik7XG4gICAgcmV0dXJuIHsgdGhyZXNob2xkTGV2ZWw6IGN1cnJlbnRTdGF0ZSwgY29sb3I6IGNvbG9yV2hpdGV9O1xuICB9XG4gIGxldCBhVGhyZXNob2xkID0gdGhyZXNob2xkc1t0aHJlc2hvbGRDb3VudCAtIDFdO1xuICBpZiAodmFsdWUgPj0gYVRocmVzaG9sZC52YWx1ZSkge1xuICAgIC8vY29uc29sZS5sb2coXCJnZXRUaHJlc2hvbGRMZXZlbEZvclZhbHVlOiB2YWx1ZSBcIiArIHZhbHVlICsgXCIgZ2UgXCIgKyBhVGhyZXNob2xkLnZhbHVlKTtcbiAgICBjdXJyZW50U3RhdGUgPSBhVGhyZXNob2xkLnN0YXRlO1xuICAgIGN1cnJlbnRDb2xvciA9IGFUaHJlc2hvbGQuY29sb3I7XG4gIH1cbiAgLy8gaWYgdGhlcmUncyBvbmUgdGhyZXNob2xkLCBqdXN0IHJldHVybiB0aGUgcmVzdWx0XG4gIGlmICh0aHJlc2hvbGRzLmxlbmd0aCA9PT0gMSkge1xuICAgIC8vY29uc29sZS5sb2coXCJnZXRUaHJlc2hvbGRMZXZlbEZvclZhbHVlOiBzaW5nbGUgdGhyZXNob2xkLCByZXR1cm5pbmcgc3RhdGUgXCIgKyBjdXJyZW50U3RhdGUpO1xuICAgIHJldHVybiB7IHRocmVzaG9sZExldmVsOiBjdXJyZW50U3RhdGUsIGNvbG9yOiBjdXJyZW50Q29sb3J9O1xuICB9XG4gIC8vIG5vdyB0ZXN0IGluIHJldmVyc2VcbiAgZm9yIChsZXQgaSA9IHRocmVzaG9sZENvdW50IC0gMTsgaSA+IDA7IGktLSkge1xuICAgIGxldCB1cHBlclRocmVzaG9sZCA9IHRocmVzaG9sZHNbaV07XG4gICAgbGV0IGxvd2VyVGhyZXNob2xkID0gdGhyZXNob2xkc1tpIC0gMV07XG4gICAgLy9jb25zb2xlLmxvZyhcImxvd2VyVGhyZXNob2xkID0gXCIgKyBsb3dlclRocmVzaG9sZC52YWx1ZSk7XG4gICAgLy9jb25zb2xlLmxvZyhcInVwcGVyVGhyZXNob2xkID0gXCIgKyB1cHBlclRocmVzaG9sZC52YWx1ZSk7XG4gICAgaWYgKChsb3dlclRocmVzaG9sZC52YWx1ZSA8PSB2YWx1ZSkgJiYgKHZhbHVlIDwgdXBwZXJUaHJlc2hvbGQudmFsdWUpKSB7XG4gICAgICAvL2NvbnNvbGUubG9nKFwiZ2V0VGhyZXNob2xkTGV2ZWxGb3JWYWx1ZTogdmFsdWUgXCIgKyB2YWx1ZSArIFwiIGlzIGJldHdlZW4gXCIgKyBsb3dlclRocmVzaG9sZC52YWx1ZSArIFwiIGFuZCBcIiArIHVwcGVyVGhyZXNob2xkLnZhbHVlKTtcbiAgICAgIGlmIChjdXJyZW50U3RhdGUgPCBsb3dlclRocmVzaG9sZC5zdGF0ZSkge1xuICAgICAgICBjdXJyZW50U3RhdGUgPSBsb3dlclRocmVzaG9sZC5zdGF0ZTtcbiAgICAgICAgY3VycmVudENvbG9yID0gbG93ZXJUaHJlc2hvbGQuY29sb3I7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIGxhc3QgY2hlY2ssIGlmIGN1cnJlbnRTdGF0ZSBpcyBub3Qgc2V0LCBhbmQgdGhlcmUgaXMgYSBsb3dlciB0aHJlc2hvbGQsIHVzZSB0aGF0IHZhbHVlIChpbmNsdXNpdmUgcmFuZ2UgdXAgdG8gVDEpXG4gIGlmIChjdXJyZW50U3RhdGUgPT09IC0xKSB7XG4gICAgY3VycmVudFN0YXRlID0gdGhyZXNob2xkc1swXS5zdGF0ZTtcbiAgICBjdXJyZW50Q29sb3IgPSB0aHJlc2hvbGRzWzBdLmNvbG9yO1xuICB9XG4gIC8vY29uc29sZS5sb2coXCJSZXR1cm5pbmcgdGhyZXNob2xkIGxldmVsOiBcIiArIGN1cnJlbnRTdGF0ZSk7XG4gIHJldHVybiB7IHRocmVzaG9sZExldmVsOiBjdXJyZW50U3RhdGUsIGNvbG9yOiBjdXJyZW50Q29sb3J9O1xufVxuXG5cbmZ1bmN0aW9uIGdldFZhbHVlQnlTdGF0TmFtZShvcGVyYXRvck5hbWU6IHN0cmluZywgZGF0YTogYW55KTogbnVtYmVyIHtcbiAgbGV0IHZhbHVlID0gZGF0YS5zdGF0cy5hdmc7XG4gIHN3aXRjaCAob3BlcmF0b3JOYW1lKSB7XG4gICAgY2FzZSBcImF2Z1wiOlxuICAgICAgdmFsdWUgPSBkYXRhLnN0YXRzLmF2ZztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJjb3VudFwiOlxuICAgICAgdmFsdWUgPSBkYXRhLnN0YXRzLmNvdW50O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImN1cnJlbnRcIjpcbiAgICAgIHZhbHVlID0gZGF0YS5zdGF0cy5jdXJyZW50O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImRlbHRhXCI6XG4gICAgICB2YWx1ZSA9IGRhdGEuc3RhdHMuZGVsdGE7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiZGlmZlwiOlxuICAgICAgdmFsdWUgPSBkYXRhLnN0YXRzLmRpZmY7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiZmlyc3RcIjpcbiAgICAgIHZhbHVlID0gZGF0YS5zdGF0cy5maXJzdDtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJsb2dtaW5cIjpcbiAgICAgIHZhbHVlID0gZGF0YS5zdGF0cy5sb2dtaW47XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwibWF4XCI6XG4gICAgICB2YWx1ZSA9IGRhdGEuc3RhdHMubWF4O1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcIm1pblwiOlxuICAgICAgdmFsdWUgPSBkYXRhLnN0YXRzLm1pbjtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJuYW1lXCI6XG4gICAgICB2YWx1ZSA9IGRhdGEubWV0cmljTmFtZTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJ0aW1lX3N0ZXBcIjpcbiAgICAgIHZhbHVlID0gZGF0YS5zdGF0cy50aW1lU3RlcDtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJsYXN0X3RpbWVcIjpcbiAgICAgIHZhbHVlID0gZGF0YS50aW1lc3RhbXA7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwidG90YWxcIjpcbiAgICAgIHZhbHVlID0gZGF0YS5zdGF0cy50b3RhbDtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICB2YWx1ZSA9IGRhdGEuc3RhdHMuYXZnO1xuICAgICAgYnJlYWs7XG4gICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxuZXhwb3J0IHtcbiAgZ2V0V29yc3RTZXJpZXMsXG4gIGdldFRocmVzaG9sZExldmVsRm9yVmFsdWUsXG4gIGdldFZhbHVlQnlTdGF0TmFtZVxufTtcbiJdfQ==